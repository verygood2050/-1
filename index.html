<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì„±ê²½ ì•”ì†¡ ì¹´ë“œ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
  
  <script>
    const { useState, useEffect } = React;
    const e = React.createElement;

    // ì•„ì´ì½˜ ì»´í¬ë„ŒíŠ¸ë“¤
    const Upload = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12'}));
    const X = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M6 18L18 6M6 6l12 12'}));
    const Download = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4'}));
    const Search = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'}));
    const BarChart3 = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M12 20V10m0 0V4m0 6h8m-8 0H4'}));
    const Shuffle = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M16 3h5m0 0v5m0-5l-6 6M4 21l6-6m11 6h-5m5 0v-5m0 5l-6-6'}));
    const Plus = ({className}) => e('svg', {className, fill:'none', stroke:'currentColor', viewBox:'0 0 24 24'}, 
      e('path', {strokeLinecap:'round', strokeLinejoin:'round', strokeWidth:2, d:'M12 4v16m8-8H4'}));

    function BibleMemoryCards() {
      const generateDefaultData = () => {
        return {
          '001': { reference: 'ì°½ì„¸ê¸° 1:1,31', text: 'íƒœì´ˆì— í•˜ë‚˜ë‹˜ì´ ì²œì§€ë¥¼ ì°½ì¡°í•˜ì‹œë‹ˆë¼  í•˜ë‚˜ë‹˜ì´ ì§€ìœ¼ì‹  ê·¸ ëª¨ë“  ê²ƒì„ ë³´ì‹œë‹ˆ ë³´ì‹œê¸°ì— ì‹¬íˆ ì¢‹ì•˜ë”ë¼ ì €ë…ì´ ë˜ê³  ì•„ì¹¨ì´ ë˜ë‹ˆ ì´ëŠ” ì—¬ì„¯ì§¸ ë‚ ì´ë‹ˆë¼' },
          '002': { reference: 'ì ì–¸ 16:9', text: 'ì‚¬ëŒì´ ë§ˆìŒìœ¼ë¡œ ìê¸°ì˜ ê¸¸ì„ ê³„íší• ì§€ë¼ë„ ê·¸ì˜ ê±¸ìŒì„ ì¸ë„í•˜ì‹œëŠ” ì´ëŠ” ì—¬í˜¸ì™€ì‹œë‹ˆë¼' },
          '003': { reference: 'ìš”í•œë³µìŒ 13:34', text: 'ìƒˆ ê³„ëª…ì„ ë„ˆí¬ì—ê²Œ ì£¼ë…¸ë‹ˆ ì„œë¡œ ì‚¬ë‘í•˜ë¼ ë‚´ê°€ ë„ˆí¬ë¥¼ ì‚¬ë‘í•œ ê²ƒ ê°™ì´ ë„ˆí¬ë„ ì„œë¡œ ì‚¬ë‘í•˜ë¼' },
          '004': { reference: 'ëˆ„ê°€ë³µìŒ 17:6', text: 'ì£¼ê»˜ì„œ ì´ë¥´ì‹œë˜ ë„ˆí¬ì—ê²Œ ê²¨ìì”¨ í•œ ì•Œë§Œí•œ ë¯¿ìŒì´ ìˆì—ˆë”ë¼ë©´ ì´ ë½•ë‚˜ë¬´ë”ëŸ¬ ë¿Œë¦¬ê°€ ë½‘í˜€ ë°”ë‹¤ì— ì‹¬ê²¨ì§€ë¼ í•˜ì˜€ì„ ê²ƒì´ìš” ê·¸ê²ƒì´ ë„ˆí¬ì—ê²Œ ìˆœì¢…í•˜ì˜€ìœ¼ë¦¬ë¼' },
          '005': { reference: 'ìš”í•œë³µìŒ 11:25', text: 'ì˜ˆìˆ˜ê»˜ì„œ ì´ë¥´ì‹œë˜ ë‚˜ëŠ” ë¶€í™œì´ìš” ìƒëª…ì´ë‹ˆ ë‚˜ë¥¼ ë¯¿ëŠ” ìëŠ” ì£½ì–´ë„ ì‚´ê² ê³ ' },
          '006': { reference: 'ëˆ„ê°€ë³µìŒ 10:36', text: 'ë„¤ ìƒê°ì—ëŠ” ì´ ì„¸ ì‚¬ëŒ ì¤‘ì— ëˆ„ê°€ ê°•ë„ ë§Œë‚œ ìì˜ ì´ì›ƒì´ ë˜ê² ëŠëƒ' },
          '007': { reference: 'ë°ì‚´ë¡œë‹ˆê°€ì „ì„œ 5:16~18', text: 'í•­ìƒ ê¸°ë»í•˜ë¼ ì‰¬ì§€ ë§ê³  ê¸°ë„í•˜ë¼ ë²”ì‚¬ì— ê°ì‚¬í•˜ë¼ ì´ê²ƒì´ ê·¸ë¦¬ìŠ¤ë„ ì˜ˆìˆ˜ ì•ˆì—ì„œ ë„ˆí¬ë¥¼ í–¥í•˜ì‹  í•˜ë‚˜ë‹˜ì˜ ëœ»ì´ë‹ˆë¼' },
          '008': { reference: 'ë§ˆíƒœë³µìŒ 1:21', text: 'ì•„ë“¤ì„ ë‚³ìœ¼ë¦¬ë‹ˆ ì´ë¦„ì„ ì˜ˆìˆ˜ë¼ í•˜ë¼ ì´ëŠ” ê·¸ê°€ ìê¸° ë°±ì„±ì„ ê·¸ë“¤ì˜ ì£„ì—ì„œ êµ¬ì›í•  ìì´ì‹¬ì´ë¼ í•˜ë‹ˆë¼' },
          '009': { reference: 'ìš”í•œë³µìŒ 1:12', text: 'ì˜ì ‘í•˜ëŠ” ì ê³§ ê·¸ ì´ë¦„ì„ ë¯¿ëŠ” ìë“¤ì—ê²ŒëŠ” í•˜ë‚˜ë‹˜ì˜ ìë…€ê°€ ë˜ëŠ” ê¶Œì„¸ë¥¼ ì£¼ì…¨ìœ¼ë‹ˆ' },
          '010': { reference: 'ì‹œí¸ 100:4', text: 'ê°ì‚¬í•¨ìœ¼ë¡œ ê·¸ì˜ ë¬¸ì— ë“¤ì–´ê°€ë©° ì°¬ì†¡í•¨ìœ¼ë¡œ ê·¸ì˜ ê¶ì •ì— ë“¤ì–´ê°€ì„œ ê·¸ì—ê²Œ ê°ì‚¬í•˜ë©° ê·¸ì˜ ì´ë¦„ì„ ì†¡ì¶•í• ì§€ì–´ë‹¤' },
          '011': { reference: 'ì ì–¸ 15:20', text: 'ì§€í˜œë¡œìš´ ì•„ë“¤ì€ ì•„ë¹„ë¥¼ ì¦ê²ê²Œ í•˜ì—¬ë„ ë¯¸ë ¨í•œ ìëŠ” ì–´ë¯¸ë¥¼ ì—…ì‹ ì—¬ê¸°ëŠë‹ˆë¼' },
          '012': { reference: 'ì ì–¸ 1:8', text: 'ë‚´ ì•„ë“¤ì•„ ë„¤ ì•„ë¹„ì˜ í›ˆê³„ë¥¼ ë“¤ìœ¼ë©° ë„¤ ì–´ë¯¸ì˜ ë²•ì„ ë– ë‚˜ì§€ ë§ë¼' },
          '013': { reference: 'ê³¨ë¡œìƒˆì„œ 3:20', text: 'ìë…€ë“¤ì•„ ëª¨ë“  ì¼ì— ë¶€ëª¨ì—ê²Œ ìˆœì¢…í•˜ë¼ ì´ëŠ” ì£¼ ì•ˆì—ì„œ ê¸°ì˜ê²Œ í•˜ëŠ” ê²ƒì´ë‹ˆë¼' },
          '014': { reference: 'ì—ë² ì†Œì„œ 6:1~2', text: 'ìë…€ë“¤ì•„ ì£¼ ì•ˆì—ì„œ ë„ˆí¬ ë¶€ëª¨ì—ê²Œ ìˆœì¢…í•˜ë¼ ì´ê²ƒì´ ì˜³ìœ¼ë‹ˆë¼ ë„¤ ì•„ë²„ì§€ì™€ ì–´ë¨¸ë‹ˆë¥¼ ê³µê²½í•˜ë¼ ì´ê²ƒì€ ì•½ì†ì´ ìˆëŠ” ì²« ê³„ëª…ì´ë‹ˆ' },
          '015': { reference: 'ê³ ë¦°ë„ì „ì„œ 13:4~5', text: 'ì‚¬ë‘ì€ ì˜¤ë˜ ì°¸ê³  ì‚¬ë‘ì€ ì˜¨ìœ í•˜ë©° ì‹œê¸°í•˜ì§€ ì•„ë‹ˆí•˜ë©° ì‚¬ë‘ì€ ìë‘í•˜ì§€ ì•„ë‹ˆí•˜ë©° êµë§Œí•˜ì§€ ì•„ë‹ˆí•˜ë©° ë¬´ë¡€íˆ í–‰í•˜ì§€ ì•„ë‹ˆí•˜ë©° ìê¸°ì˜ ìœ ìµì„ êµ¬í•˜ì§€ ì•„ë‹ˆí•˜ë©° ì„±ë‚´ì§€ ì•„ë‹ˆí•˜ë©° ì•…í•œ ê²ƒì„ ìƒê°í•˜ì§€ ì•„ë‹ˆí•˜ë©°' },
          '016': { reference: 'ì‹œí¸ 119:105', text: 'ì£¼ì˜ ë§ì”€ì€ ë‚´ ë°œì— ë“±ì´ìš” ë‚´ ê¸¸ì— ë¹›ì´ë‹ˆì´ë‹¤' },
          '017': { reference: 'ì´ì‚¬ì•¼ 53:6', text: 'ìš°ë¦¬ëŠ” ë‹¤ ì–‘ ê°™ì•„ì„œ ê·¸ë¦‡ í–‰í•˜ì—¬ ê°ê¸° ì œ ê¸¸ë¡œ ê°”ê±°ëŠ˜ ì—¬í˜¸ì™€ê»˜ì„œëŠ” ìš°ë¦¬ ëª¨ë‘ì˜ ì£„ì•…ì„ ê·¸ì—ê²Œ ë‹´ë‹¹ì‹œí‚¤ì…¨ë„ë‹¤' },
          '018': { reference: 'ë¡œë§ˆì„œ 1:16', text: 'ë‚´ê°€ ë³µìŒì„ ë¶€ë„ëŸ¬ì›Œí•˜ì§€ ì•„ë‹ˆí•˜ë…¸ë‹ˆ ì´ ë³µìŒì€ ëª¨ë“  ë¯¿ëŠ” ìì—ê²Œ êµ¬ì›ì„ ì£¼ì‹œëŠ” í•˜ë‚˜ë‹˜ì˜ ëŠ¥ë ¥ì´ ë¨ì´ë¼ ë¨¼ì €ëŠ” ìœ ëŒ€ì¸ì—ê²Œìš” ê·¸ë¦¬ê³  í—¬ë¼ì¸ì—ê²Œë¡œë‹¤' },
          '019': { reference: 'ë§ˆíƒœë³µìŒ 20:28', text: 'ì¸ìê°€ ì˜¨ ê²ƒì€ ì„¬ê¹€ì„ ë°›ìœ¼ë ¤ í•¨ì´ ì•„ë‹ˆë¼ ë„ë¦¬ì–´ ì„¬ê¸°ë ¤ í•˜ê³  ìê¸° ëª©ìˆ¨ì„ ë§ì€ ì‚¬ëŒì˜ ëŒ€ì†ë¬¼ë¡œ ì£¼ë ¤ í•¨ì´ë‹ˆë¼' },
          '020': { reference: 'ê³¨ë¡œìƒˆì„œ 3:23', text: 'ë¬´ìŠ¨ ì¼ì„ í•˜ë“ ì§€ ë§ˆìŒì„ ë‹¤í•˜ì—¬ ì£¼ê»˜ í•˜ë“¯ í•˜ê³  ì‚¬ëŒì—ê²Œ í•˜ë“¯ í•˜ì§€ ë§ë¼' },
          '021': { reference: 'ë§ˆíƒœë³µìŒ 16:16,18', text: 'ì‹œëª¬ ë² ë“œë¡œê°€ ëŒ€ë‹µí•˜ì—¬ ì´ë¥´ë˜ ì£¼ëŠ” ê·¸ë¦¬ìŠ¤ë„ì‹œìš” ì‚´ì•„ ê³„ì‹  í•˜ë‚˜ë‹˜ì˜ ì•„ë“¤ì´ì‹œë‹ˆì´ë‹¤ / ë˜ ë‚´ê°€ ë„¤ê²Œ ì´ë¥´ë…¸ë‹ˆ ë„ˆëŠ” ë² ë“œë¡œë¼ ë‚´ê°€ ì´ ë°˜ì„ ìœ„ì— ë‚´ êµíšŒë¥¼ ì„¸ìš°ë¦¬ë‹ˆ ìŒë¶€ì˜ ê¶Œì„¸ê°€ ì´ê¸°ì§€ ëª»í•˜ë¦¬ë¼' },
          '022': { reference: 'ë§ˆíƒœë³µìŒ 5:16', text: 'ì´ê°™ì´ ë„ˆí¬ ë¹›ì´ ì‚¬ëŒ ì•ì— ë¹„ì¹˜ê²Œ í•˜ì—¬ ê·¸ë“¤ë¡œ ë„ˆí¬ ì°©í•œ í–‰ì‹¤ì„ ë³´ê³  í•˜ëŠ˜ì— ê³„ì‹  ë„ˆí¬ ì•„ë²„ì§€ê»˜ ì˜ê´‘ì„ ëŒë¦¬ê²Œ í•˜ë¼' },
          '023': { reference: 'ì‹œí¸ 136:1', text: 'ì—¬í˜¸ì™€ê»˜ ê°ì‚¬í•˜ë¼ ê·¸ëŠ” ì„ í•˜ì‹œë©° ê·¸ ì¸ìí•˜ì‹¬ì´ ì˜ì›í•¨ì´ë¡œë‹¤' }
        };
      };

      const [verses, setVerses] = useState({});
      const [isLoading, setIsLoading] = useState(true);
      const [selectedCard, setSelectedCard] = useState('001');
      const [showUploadModal, setShowUploadModal] = useState(false);
      const [uploadMethod, setUploadMethod] = useState('paste'); // 'paste' or 'manual'
      const [pasteText, setPasteText] = useState('');
      const [manualCard, setManualCard] = useState({number: '', reference: '', text: ''});
      const [notification, setNotification] = useState('');
      const [counts, setCounts] = useState({});
      const [showAllCounts, setShowAllCounts] = useState(false);
      const [showAllVerses, setShowAllVerses] = useState(false);
      const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
      const [showDeleteMenu, setShowDeleteMenu] = useState(false);
      const [showSearchModal, setShowSearchModal] = useState(false);
      const [searchQuery, setSearchQuery] = useState('');
      const [showStatsModal, setShowStatsModal] = useState(false);
      const [showQuizMode, setShowQuizMode] = useState(false);
      const [quizCard, setQuizCard] = useState(null);
      const [showQuizAnswer, setShowQuizAnswer] = useState(false);
      const [dailyHistory, setDailyHistory] = useState({});
      const [encouragementMsg, setEncouragementMsg] = useState('');

      const STORAGE_KEYS = { verses: 'bibleMemoryVerses', counts: 'bibleMemoryCounts', history: 'bibleDailyHistory' };

      useEffect(() => {
        const loadData = () => {
          try {
            const savedVerses = localStorage.getItem(STORAGE_KEYS.verses);
            const savedCounts = localStorage.getItem(STORAGE_KEYS.counts);
            const savedHistory = localStorage.getItem(STORAGE_KEYS.history);
            
            if (savedVerses) {
              setVerses(JSON.parse(savedVerses));
            } else {
              const initialData = generateDefaultData();
              setVerses(initialData);
              localStorage.setItem(STORAGE_KEYS.verses, JSON.stringify(initialData));
            }
            if (savedCounts) setCounts(JSON.parse(savedCounts));
            if (savedHistory) setDailyHistory(JSON.parse(savedHistory));
          } catch (error) {
            const initialData = generateDefaultData();
            setVerses(initialData);
          }
          setIsLoading(false);
        };
        loadData();
      }, []);

      useEffect(() => {
        if (!isLoading && Object.keys(verses).length > 0) {
          localStorage.setItem(STORAGE_KEYS.verses, JSON.stringify(verses));
        }
      }, [verses, isLoading]);

      useEffect(() => {
        if (!isLoading) localStorage.setItem(STORAGE_KEYS.counts, JSON.stringify(counts));
      }, [counts, isLoading]);

      useEffect(() => {
        if (!isLoading) localStorage.setItem(STORAGE_KEYS.history, JSON.stringify(dailyHistory));
      }, [dailyHistory, isLoading]);

      const notify = (message, duration = 3000) => {
        setNotification(message);
        setTimeout(() => setNotification(''), duration);
      };

      const parseContent = (text) => {
        const lines = text.split('\n').map(l => l.trim()).filter(l => l.length > 0);
        const updates = {};
        let successCount = 0;

        lines.forEach(line => {
          if (line.includes('ë²ˆí˜¸') || line.includes('ì„±ê²½')) return;
          
          // íƒ­ìœ¼ë¡œ êµ¬ë¶„ëœ í˜•ì‹ (ì—‘ì…€ ë³µì‚¬)
          let parts = line.split('\t').map(p => p.trim()).filter(p => p);
          
          // íƒ­ì´ ì—†ìœ¼ë©´ ê³µë°±ìœ¼ë¡œ ì‹œë„
          if (parts.length < 3) {
            parts = line.split(/\s{2,}/).map(p => p.trim()).filter(p => p);
          }
          
          // ì—¬ì „íˆ ë¶€ì¡±í•˜ë©´ ì •ê·œì‹ìœ¼ë¡œ ì‹œë„
          if (parts.length < 3) {
            const normalized = line.replace(/[\s]+/g, ' ').trim();
            const pattern = /^([A-E]?0?\d{1,3})\s+(.+?)\s+(\d+)\s*[:\s]\s*(\d+(?:\s*[-,~]\s*\d+)?)\s+(.+?)\.?$/;
            const match = normalized.match(pattern);
            
            if (match) {
              let cardKey = match[1].toUpperCase();
              if (cardKey.length === 1 || cardKey.length === 2) cardKey = cardKey.padStart(3, '0');
              const reference = match[2].trim() + ' ' + match[3] + ':' + match[4].replace(/\s/g, '');
              updates[cardKey] = { reference, text: match[5].trim() };
              successCount++;
              return;
            }
          }
          
          // íƒ­/ê³µë°± êµ¬ë¶„ í˜•ì‹ ì²˜ë¦¬
          if (parts.length >= 3) {
            let cardKey = parts[0].toUpperCase();
            if (cardKey.length === 1 || cardKey.length === 2) cardKey = cardKey.padStart(3, '0');
            
            // ë‘ ë²ˆì§¸ ë¶€ë¶„ì´ ì„±ê²½ì±… ì´ë¦„ì¸ì§€ í™•ì¸
            const bookPattern = /^[ê°€-í£\s]+$/;
            if (bookPattern.test(parts[1])) {
              const reference = parts[1] + ' ' + parts[2];
              const text = parts.slice(3).join(' ');
              if (text.length > 0) {
                updates[cardKey] = { reference, text };
                successCount++;
              }
            } else {
              // ì„±ê²½ êµ¬ì ˆì´ í•˜ë‚˜ë¡œ í•©ì³ì§„ ê²½ìš°
              const refMatch = parts[1].match(/^(.+?)\s*(\d+)\s*[:]\s*(\d+(?:\s*[-,~]\s*\d+)?)$/);
              if (refMatch) {
                const reference = refMatch[1].trim() + ' ' + refMatch[2] + ':' + refMatch[3].replace(/\s/g, '');
                const text = parts.slice(2).join(' ');
                if (text.length > 0) {
                  updates[cardKey] = { reference, text };
                  successCount++;
                }
              }
            }
          }
        });
        
        return { updates, successCount };
      };

      const handlePasteSubmit = () => {
        if (!pasteText.trim()) {
          notify('âš ï¸ ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
          return;
        }
        const { updates, successCount } = parseContent(pasteText);
        if (successCount > 0) {
          setVerses(prev => ({ ...prev, ...updates }));
          notify(`âœ… ${successCount}ê°œì˜ ë§ì”€ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤`);
          setPasteText('');
          setShowUploadModal(false);
        } else {
          notify('âŒ ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ë§ì”€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        }
      };

      const handleManualSubmit = () => {
        if (!manualCard.number || !manualCard.reference || !manualCard.text) {
          notify('âš ï¸ ëª¨ë“  í•­ëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”');
          return;
        }
        let cardKey = manualCard.number.toUpperCase();
        if (cardKey.length === 1 || cardKey.length === 2) cardKey = cardKey.padStart(3, '0');
        
        setVerses(prev => ({
          ...prev,
          [cardKey]: { reference: manualCard.reference, text: manualCard.text }
        }));
        notify('âœ… ë§ì”€ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤');
        setManualCard({number: '', reference: '', text: ''});
        setShowUploadModal(false);
      };

      const handleBackup = () => {
        const backupData = { verses, counts, dailyHistory, backupDate: new Date().toISOString() };
        const blob = new Blob([JSON.stringify(backupData, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `ì„±ê²½ì•”ì†¡ì¹´ë“œ_ë°±ì—…_${new Date().toISOString().split('T')[0]}.json`;
        a.click();
        URL.revokeObjectURL(url);
        notify('âœ… ë°±ì—… ì™„ë£Œ');
      };

      const handleRestore = (event) => {
        const file = event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (ev) => {
          try {
            const data = JSON.parse(ev.target.result);
            if (data.verses) {
              setVerses(data.verses);
              setCounts(data.counts || {});
              setDailyHistory(data.dailyHistory || {});
              notify('âœ… ë³µì› ì™„ë£Œ');
            }
          } catch (error) {
            notify('âŒ íŒŒì¼ ì˜¤ë¥˜');
          }
        };
        reader.readAsText(file);
        event.target.value = '';
      };

      const handleTextFileImport = (event) => {
        const file = event.target.files[0];
        if (!file) return;
        const reader = new FileReader();
        reader.onload = (ev) => {
          try {
            const text = ev.target.result;
            const { updates, successCount } = parseContent(text);
            if (successCount > 0) {
              setVerses(prev => ({ ...prev, ...updates }));
              notify(`âœ… ${successCount}ê°œì˜ ë§ì”€ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤`);
              setShowUploadModal(false);
            } else {
              notify('âŒ ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ë§ì”€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
            }
          } catch (error) {
            notify('âŒ íŒŒì¼ ì½ê¸° ì˜¤ë¥˜');
          }
        };
        reader.readAsText(file);
        event.target.value = '';
      };

      const handleWordFileImport = async (event) => {
        const file = event.target.files[0];
        if (!file) return;
        
        try {
          const arrayBuffer = await file.arrayBuffer();
          const result = await mammoth.extractRawText({ arrayBuffer });
          const text = result.value;
          
          const { updates, successCount } = parseContent(text);
          if (successCount > 0) {
            setVerses(prev => ({ ...prev, ...updates }));
            notify(`âœ… ${successCount}ê°œì˜ ë§ì”€ì„ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤`);
            setShowUploadModal(false);
          } else {
            notify('âŒ ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ë§ì”€ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
          }
        } catch (error) {
          notify('âŒ ì›Œë“œ íŒŒì¼ ì½ê¸° ì˜¤ë¥˜');
        }
        event.target.value = '';
      };

      const searchVerses = () => {
        const validKeys = Object.keys(verses).filter(k => verses[k].reference && verses[k].text);
        if (!searchQuery.trim()) return validKeys;
        const query = searchQuery.toLowerCase();
        return validKeys.filter(key => {
          const v = verses[key];
          return v.reference?.toLowerCase().includes(query) || v.text?.toLowerCase().includes(query);
        });
      };

      const selectRandomCard = () => {
        const validCards = Object.keys(verses).filter(k => verses[k].reference && verses[k].text);
        if (validCards.length === 0) {
          notify('âš ï¸ ë“±ë¡ëœ ë§ì”€ì´ ì—†ìŠµë‹ˆë‹¤');
          return;
        }
        const randomKey = validCards[Math.floor(Math.random() * validCards.length)];
        setQuizCard(randomKey);
        setShowQuizAnswer(false);
        setShowQuizMode(true);
      };

      const playSuccessSound = () => {
        const audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const duration = 0.3;
        [523.25, 659.25, 783.99].forEach((freq, i) => {
          const osc = audioContext.createOscillator();
          const gain = audioContext.createGain();
          osc.connect(gain);
          gain.connect(audioContext.destination);
          osc.frequency.value = freq;
          gain.gain.setValueAtTime(0.3, audioContext.currentTime + i*0.15);
          gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + i*0.15 + duration);
          osc.start(audioContext.currentTime + i*0.15);
          osc.stop(audioContext.currentTime + i*0.15 + duration);
        });
      };

      const incrementCount = (cardKey) => {
        const today = new Date().toISOString().split('T')[0];
        const newCount = (counts[cardKey] || 0) + 1;
        setCounts(prev => ({...prev, [cardKey]: newCount}));
        setDailyHistory(prev => ({
          ...prev,
          [today]: { ...prev[today], [cardKey]: ((prev[today]?.[cardKey]) || 0) + 1 }
        }));
        if (newCount > 0 && newCount % 10 === 0) {
          playSuccessSound();
          setEncouragementMsg(`ğŸ‰ ${newCount}íšŒ ë‹¬ì„±!`);
          setTimeout(() => setEncouragementMsg(''), 3000);
        }
      };

      const getStats = () => {
        const totalCount = Object.values(counts).reduce((sum, c) => sum + c, 0);
        const activeCards = Object.values(counts).filter(c => c > 0).length;
        const verseCards = Object.keys(verses).filter(k => verses[k].reference && verses[k].text).length;
        return { totalCount, activeCards, verseCards };
      };

      const handleDeleteCard = () => {
        const newVerses = {...verses};
        delete newVerses[selectedCard];
        setVerses(newVerses);
        const remainingKeys = Object.keys(newVerses).sort();
        if (remainingKeys.length > 0) setSelectedCard(remainingKeys[0]);
        setShowDeleteConfirm(false);
        notify('âœ… ì‚­ì œ ì™„ë£Œ');
      };

      const handleDeleteAllCards = () => {
        const defaultData = generateDefaultData();
        setVerses(defaultData);
        setCounts({});
        setDailyHistory({});
        setSelectedCard('001');
        setShowDeleteConfirm(false);
        setShowDeleteMenu(false);
        notify('âœ… ê¸°ë³¸ ë°ì´í„°ë¡œ ì´ˆê¸°í™”');
      };

      const keys = Object.keys(verses).sort();
      const currentCard = verses[selectedCard] || { reference: '', text: '' };
      const currentCount = counts[selectedCard] || 0;
      const stats = getStats();

      const getCharacter = (count) => {
        if (count === 0) return 'ğŸ˜Š';
        if (count < 10) return 'ğŸ»';
        if (count < 20) return 'ğŸ±';
        if (count < 50) return 'ğŸ°';
        return 'ğŸ‘‘';
      };

      return e('div', {className: 'min-h-screen', style: {background: 'linear-gradient(180deg, #e8eaf6 0%, #f3e5f5 100%)'}},
        notification && e('div', {className: 'fixed top-4 left-1/2 transform -translate-x-1/2 bg-white px-6 py-3 rounded-xl font-bold shadow-2xl z-50'}, notification),
        
        e('div', {className: 'max-w-md mx-auto p-4'},
          e('div', {className: 'bg-white shadow-lg rounded-3xl p-4 mb-3'},
            e('h1', {className: 'text-2xl font-black text-center mb-4 text-purple-700'}, 'ğŸ“– ì„±ê²½ ì•”ì†¡ ì¹´ë“œ ğŸ“–'),
            keys.length > 0 ? 
              e('select', {
                value: selectedCard,
                onChange: (ev) => setSelectedCard(ev.target.value),
                className: 'w-full px-3 py-2 border-2 border-purple-300 rounded-xl font-bold'
              }, keys.map(key => e('option', {key, value: key}, `${key} - ${verses[key].reference || 'ë¹ˆ ì¹´ë“œ'}`)))
            : e('div', {className: 'text-center py-4'},
                e('p', {className: 'text-gray-400 font-bold mb-2'}, 'ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤'),
                e('button', {
                  onClick: () => setShowUploadModal(true),
                  className: 'px-6 py-2 bg-purple-500 text-white rounded-lg font-bold'
                }, 'ë§ì”€ ì¶”ê°€í•˜ê¸°'))
          ),

          keys.length > 0 && e(React.Fragment, null,
            e('div', {className: 'bg-white rounded-3xl p-5 shadow-lg mb-4'},
              e('div', {className: 'text-center mb-3'},
                e('div', {className: 'font-black text-purple-600 text-xl'}, selectedCard),
                currentCard.reference && e('div', {className: 'font-black text-gray-900 text-lg'}, currentCard.reference)
              ),
              currentCard.text && e('div', {className: 'font-bold text-gray-800 text-base leading-relaxed'}, currentCard.text)
            ),

            e('div', {className: 'bg-white rounded-3xl p-6 shadow-lg'},
              e('div', {className: 'flex items-center justify-center gap-4 mb-4'},
                e('div', {className: 'text-6xl'}, getCharacter(currentCount)),
                e('div', {className: 'text-7xl font-black text-purple-600'}, currentCount)
              ),
              encouragementMsg && e('div', {className: 'mb-4 bg-yellow-100 rounded-xl p-3 text-center'},
                e('p', {className: 'font-black text-purple-700'}, encouragementMsg)
              ),
              e('div', {className: 'flex gap-4 justify-center mb-3'},
                e('button', {
                  onClick: () => setCounts(prev => ({...prev, [selectedCard]: Math.max(0, (prev[selectedCard] || 0) - 1)})),
                  className: 'w-20 py-2 bg-red-500 text-white rounded-xl font-black text-2xl'
                }, '-1'),
                e('button', {
                  onClick: () => incrementCount(selectedCard),
                  className: 'w-20 py-2 bg-green-500 text-white rounded-xl font-black text-2xl'
                }, '+1')
              ),
              e('button', {
                onClick: () => setCounts(prev => ({...prev, [selectedCard]: 0})),
                className: 'w-full p-2 bg-gray-300 rounded-xl font-bold text-sm'
              }, 'í˜„ì¬ ì¹´ë“œ ì´ˆê¸°í™”')
            )
          ),

          e('div', {className: 'mt-4 bg-white rounded-3xl p-4 shadow-lg'},
            e('div', {className: 'grid grid-cols-4 gap-2 mb-2'},
              e('button', {onClick: () => { setShowUploadModal(true); setUploadMethod('paste'); }, className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-xl font-bold text-xs'},
                e(Upload, {className: 'w-5 h-5 mb-1'}), 'ì¼ê´„ì¶”ê°€'),
              e('button', {onClick: () => { setShowUploadModal(true); setUploadMethod('manual'); }, className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-cyan-500 to-cyan-600 text-white rounded-xl font-bold text-xs'},
                e(Plus, {className: 'w-5 h-5 mb-1'}), 'ê°œë³„ì¶”ê°€'),
              e('button', {onClick: () => setShowAllVerses(true), className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-green-500 to-green-600 text-white rounded-xl font-bold text-xs'},
                e('span', {className: 'text-lg mb-1'}, 'ğŸ“–'), 'ëª©ë¡'),
              e('button', {onClick: () => setShowSearchModal(true), className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-teal-500 to-teal-600 text-white rounded-xl font-bold text-xs'},
                e(Search, {className: 'w-5 h-5 mb-1'}), 'ê²€ìƒ‰')
            ),
            e('div', {className: 'grid grid-cols-4 gap-2'},
              e('button', {onClick: selectRandomCard, className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-pink-500 to-pink-600 text-white rounded-xl font-bold text-xs'},
                e(Shuffle, {className: 'w-5 h-5 mb-1'}), 'í€´ì¦ˆ'),
              e('button', {onClick: () => setShowAllCounts(true), className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-purple-500 to-purple-600 text-white rounded-xl font-bold text-xs'},
                e('span', {className: 'text-lg mb-1'}, 'ğŸ“Š'), 'ê¸°ë¡'),
              e('button', {onClick: () => setShowStatsModal(true), className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-orange-500 to-orange-600 text-white rounded-xl font-bold text-xs'},
                e(BarChart3, {className: 'w-5 h-5 mb-1'}), 'í†µê³„'),
              e('button', {onClick: handleBackup, className: 'flex flex-col items-center justify-center p-3 bg-gradient-to-br from-indigo-500 to-indigo-600 text-white rounded-xl font-bold text-xs'},
                e(Download, {className: 'w-5 h-5 mb-1'}), 'ë°±ì—…')
            )
          )
        ),

        // ë§ì”€ ì¶”ê°€ ëª¨ë‹¬
        showUploadModal && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-lg max-h-[90vh] flex flex-col'},
            e('h2', {className: 'text-2xl font-black mb-4'}, uploadMethod === 'paste' ? 'ğŸ“‹ ë§ì”€ ì¼ê´„ ì¶”ê°€' : 'âœï¸ ë§ì”€ ê°œë³„ ì¶”ê°€'),
            
            uploadMethod === 'paste' ? e('div', {className: 'flex-1 flex flex-col'},
              e('div', {className: 'mb-3 p-3 bg-blue-50 rounded-lg text-sm'},
                e('p', {className: 'font-bold mb-2'}, 'ğŸ“ ì§€ì› í˜•ì‹:'),
                e('p', {className: 'mb-1'}, 'â€¢ 001 ì°½ì„¸ê¸° 1:1 íƒœì´ˆì— í•˜ë‚˜ë‹˜ì´...'),
                e('p', {className: 'mb-1'}, 'â€¢ 001\tì°½ì„¸ê¸° 1:1\tíƒœì´ˆì— í•˜ë‚˜ë‹˜ì´... (ì—‘ì…€)'),
                e('p', {}, 'â€¢ A01  ìš”í•œë³µìŒ  3:16  í•˜ë‚˜ë‹˜ì´ ì„¸ìƒì„...')
              ),
              e('textarea', {
                value: pasteText,
                onChange: (ev) => setPasteText(ev.target.value),
                className: 'flex-1 p-3 border-2 rounded-lg mb-3 min-h-[200px]',
                placeholder: 'ì—¬ëŸ¬ ì¤„ì„ í•œ ë²ˆì— ë¶™ì—¬ë„£ê¸°...'
              }),
              e('div', {className: 'flex gap-2 mb-3'},
                e('button', {onClick: handlePasteSubmit, className: 'flex-1 p-3 bg-blue-600 text-white rounded-lg font-bold'}, 'ì¶”ê°€í•˜ê¸°'),
                e('button', {onClick: () => setShowUploadModal(false), className: 'flex-1 p-3 bg-gray-300 rounded-lg font-bold'}, 'ë‹«ê¸°')
              ),
              e('div', {className: 'space-y-2'},
                e('label', {className: 'block w-full p-3 border-2 border-dashed rounded-lg text-center cursor-pointer hover:bg-gray-50'},
                  e('span', {className: 'font-bold'}, 'ğŸ“„ í…ìŠ¤íŠ¸ íŒŒì¼ (.txt)'),
                  e('input', {type: 'file', accept: '.txt', onChange: handleTextFileImport, className: 'hidden'})
                ),
                e('label', {className: 'block w-full p-3 border-2 border-dashed rounded-lg text-center cursor-pointer hover:bg-blue-50'},
                  e('span', {className: 'font-bold'}, 'ğŸ“ ì›Œë“œ íŒŒì¼ (.docx)'),
                  e('input', {type: 'file', accept: '.docx', onChange: handleWordFileImport, className: 'hidden'})
                ),
                e('label', {className: 'block w-full p-3 border-2 border-dashed rounded-lg text-center cursor-pointer hover:bg-gray-50'},
                  e('span', {className: 'font-bold'}, 'ğŸ“ ë°±ì—… íŒŒì¼ (.json)'),
                  e('input', {type: 'file', accept: '.json', onChange: handleRestore, className: 'hidden'})
                )
              )
            ) : e('div', {className: 'flex-1 flex flex-col'},
              e('div', {className: 'space-y-3 mb-4'},
                e('div', null,
                  e('label', {className: 'block font-bold mb-1'}, 'ì¹´ë“œ ë²ˆí˜¸'),
                  e('input', {
                    type: 'text',
                    value: manualCard.number,
                    onChange: (ev) => setManualCard({...manualCard, number: ev.target.value}),
                    className: 'w-full p-3 border-2 rounded-lg',
                    placeholder: 'ì˜ˆ: 001, A01'
                  })
                ),
                e('div', null,
                  e('label', {className: 'block font-bold mb-1'}, 'ì„±ê²½ êµ¬ì ˆ'),
                  e('input', {
                    type: 'text',
                    value: manualCard.reference,
                    onChange: (ev) => setManualCard({...manualCard, reference: ev.target.value}),
                    className: 'w-full p-3 border-2 rounded-lg',
                    placeholder: 'ì˜ˆ: ìš”í•œë³µìŒ 3:16'
                  })
                ),
                e('div', null,
                  e('label', {className: 'block font-bold mb-1'}, 'ë§ì”€'),
                  e('textarea', {
                    value: manualCard.text,
                    onChange: (ev) => setManualCard({...manualCard, text: ev.target.value}),
                    className: 'w-full p-3 border-2 rounded-lg min-h-[150px]',
                    placeholder: 'ë§ì”€ ì „ì²´ë¥¼ ì…ë ¥í•˜ì„¸ìš”...'
                  })
                )
              ),
              e('div', {className: 'flex gap-2'},
                e('button', {onClick: handleManualSubmit, className: 'flex-1 p-3 bg-green-600 text-white rounded-lg font-bold'}, 'ì¶”ê°€í•˜ê¸°'),
                e('button', {onClick: () => setShowUploadModal(false), className: 'flex-1 p-3 bg-gray-300 rounded-lg font-bold'}, 'ë‹«ê¸°')
              )
            )
          )
        ),

        showSearchModal && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-lg max-h-96 flex flex-col'},
            e('h2', {className: 'text-2xl font-black mb-4'}, 'ğŸ” ê²€ìƒ‰'),
            e('input', {
              type: 'text',
              value: searchQuery,
              onChange: (ev) => setSearchQuery(ev.target.value),
              placeholder: 'ê²€ìƒ‰ì–´ ì…ë ¥...',
              className: 'w-full p-3 border-2 rounded-xl mb-4'
            }),
            e('div', {className: 'flex-1 overflow-y-auto space-y-2'},
              searchVerses().length === 0 ?
                e('div', {className: 'text-center text-gray-500 py-8'}, 'ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤') :
                searchVerses().map(key => e('div', {
                  key,
                  onClick: () => { setSelectedCard(key); setShowSearchModal(false); setSearchQuery(''); },
                  className: 'bg-purple-50 rounded-xl p-3 cursor-pointer hover:bg-purple-100'
                },
                  e('div', {className: 'font-black text-purple-600'}, `${key} - ${verses[key].reference}`),
                  e('div', {className: 'text-sm text-gray-700'}, verses[key].text?.substring(0, 50) + '...')
                ))
            ),
            e('button', {onClick: () => setShowSearchModal(false), className: 'mt-4 p-3 bg-gray-300 rounded-xl font-bold'}, 'ë‹«ê¸°')
          )
        ),

        showStatsModal && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-lg'},
            e('h2', {className: 'text-2xl font-black mb-4'}, 'ğŸ“Š í†µê³„'),
            e('div', {className: 'bg-purple-50 rounded-xl p-4 mb-4'},
              e('div', {className: 'flex justify-between mb-2'},
                e('span', {className: 'font-bold'}, 'ì´ ì•”ì†¡ íšŸìˆ˜:'),
                e('span', {className: 'text-purple-600 font-black'}, `${stats.totalCount}íšŒ`)
              ),
              e('div', {className: 'flex justify-between mb-2'},
                e('span', {className: 'font-bold'}, 'ì•”ì†¡í•œ ì¹´ë“œ:'),
                e('span', {className: 'text-purple-600 font-black'}, `${stats.activeCards}ê°œ`)
              ),
              e('div', {className: 'flex justify-between'},
                e('span', {className: 'font-bold'}, 'ë“±ë¡ëœ ë§ì”€:'),
                e('span', {className: 'text-purple-600 font-black'}, `${stats.verseCards}ê°œ`)
              )
            ),
            e('button', {onClick: () => setShowStatsModal(false), className: 'w-full p-3 bg-gray-300 rounded-xl font-bold'}, 'ë‹«ê¸°')
          )
        ),

        showQuizMode && quizCard && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-lg'},
            e('h2', {className: 'text-2xl font-black mb-4'}, 'ğŸ¯ í€´ì¦ˆ'),
            e('div', {className: 'bg-purple-50 rounded-2xl p-6 mb-4 text-center'},
              e('div', {className: 'text-3xl font-black text-purple-600 mb-4'}, quizCard),
              !showQuizAnswer ? 
                e('div', {className: 'text-6xl mb-4'}, 'ğŸ¤”') :
                e('div', null,
                  e('div', {className: 'font-black text-xl mb-2'}, verses[quizCard].reference),
                  e('div', {className: 'font-bold text-gray-800'}, verses[quizCard].text)
                )
            ),
            e('div', {className: 'flex gap-3'},
              !showQuizAnswer ? 
                e(React.Fragment, null,
                  e('button', {onClick: () => setShowQuizAnswer(true), className: 'flex-1 p-4 bg-purple-500 text-white rounded-xl font-bold'}, 'ì •ë‹µ ë³´ê¸°'),
                  e('button', {onClick: selectRandomCard, className: 'p-4 bg-gray-300 rounded-xl'}, e(Shuffle, {className: 'w-6 h-6'}))
                ) :
                e(React.Fragment, null,
                  e('button', {onClick: () => { incrementCount(quizCard); selectRandomCard(); }, className: 'flex-1 p-4 bg-green-500 text-white rounded-xl font-bold'}, 'âœ… ë§ì·„ì–´ìš”'),
                  e('button', {onClick: selectRandomCard, className: 'flex-1 p-4 bg-orange-500 text-white rounded-xl font-bold'}, 'âŒ ë‹¤ìŒ ë¬¸ì œ')
                )
            ),
            e('button', {onClick: () => setShowQuizMode(false), className: 'w-full mt-3 p-3 bg-gray-200 rounded-xl font-bold'}, 'ë‹«ê¸°')
          )
        ),

        showAllCounts && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-lg max-h-96 flex flex-col'},
            e('h2', {className: 'text-2xl font-black mb-4'}, 'ğŸ“Š ì „ì²´ ê¸°ë¡'),
            e('div', {className: 'flex-1 overflow-y-auto'},
              e('div', {className: 'grid grid-cols-6 gap-2'},
                keys.map(key => e('button', {
                  key,
                  onClick: () => { setSelectedCard(key); setShowAllCounts(false); },
                  className: 'p-3 bg-purple-100 rounded-xl hover:bg-purple-200'
                },
                  e('div', {className: 'text-xs font-black'}, key),
                  e('div', {className: 'text-lg font-black text-purple-600'}, counts[key] || 0)
                ))
              )
            ),
            e('button', {onClick: () => setShowAllCounts(false), className: 'mt-4 p-3 bg-gray-300 rounded-xl font-bold'}, 'ë‹«ê¸°')
          )
        ),

        showAllVerses && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-lg max-h-96 flex flex-col'},
            e('h2', {className: 'text-2xl font-black mb-4'}, 'ğŸ“– ë§ì”€ ëª©ë¡'),
            e('div', {className: 'flex-1 overflow-y-auto space-y-2'},
              keys.filter(k => verses[k].reference && verses[k].text).map(key => e('div', {
                key,
                onClick: () => { setSelectedCard(key); setShowAllVerses(false); },
                className: 'bg-purple-50 rounded-xl p-3 cursor-pointer hover:bg-purple-100'
              },
                e('div', {className: 'font-black text-purple-600'}, `${key} - ${verses[key].reference}`),
                e('div', {className: 'text-sm'}, verses[key].text?.substring(0, 50) + '...')
              ))
            ),
            e('div', {className: 'mt-4 flex gap-2'},
              e('button', {onClick: () => setShowDeleteMenu(true), className: 'p-3 bg-red-500 text-white rounded-xl font-bold'}, 'ğŸ—‘ï¸ ì´ˆê¸°í™”'),
              e('button', {onClick: () => setShowAllVerses(false), className: 'flex-1 p-3 bg-gray-300 rounded-xl font-bold'}, 'ë‹«ê¸°')
            )
          )
        ),

        showDeleteMenu && e('div', {className: 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4'},
          e('div', {className: 'bg-white rounded-3xl p-6 w-full max-w-sm'},
            e('h2', {className: 'text-2xl font-black mb-4'}, 'âš ï¸ ì´ˆê¸°í™”'),
            e('p', {className: 'mb-6 font-bold text-gray-700'}, 'ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê³  ê¸°ë³¸ ë§ì”€ 50ê°œë¡œ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?'),
            e('div', {className: 'flex gap-3'},
              e('button', {onClick: () => setShowDeleteMenu(false), className: 'flex-1 p-3 bg-gray-300 rounded-xl font-bold'}, 'ì·¨ì†Œ'),
              e('button', {onClick: handleDeleteAllCards, className: 'flex-1 p-3 bg-red-600 text-white rounded-xl font-bold'}, 'ì´ˆê¸°í™”')
            )
          )
        )
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(e(BibleMemoryCards));
  </script>
</body>
</html>